The Actual Bug

You generate rasters in NZTM2000 (EPSG:2193, metres).

Then you’re displaying them in WGS84 (EPSG:4326, degrees) by just assigning corner coordinates ([south, west], [north, east]).

That assumes the raster grid is a perfect rectangle in degrees.

But a rectangle in metres is not a rectangle in degrees — longitude “squeezes” as you go south, so your simple bounding box assignment introduces distortion.

The bigger the mosaic → the worse the misalignment, because the curvature difference compounds.

The Fix (High-Level)

Instead of “faking” the raster position with just corner coordinates in degrees, you must actually reproject the raster from EPSG:2193 → EPSG:4326 before sending it to Folium. That way, the warping is handled correctly, and each pixel lands where it belongs.

How to Fix in Code
1. Stop passing corner bounds in degrees directly

Currently you’re doing something like:

bounds = [[south_lat, west_lon], [north_lat, east_lon]]
folium.raster_layers.ImageOverlay(image=z, bounds=bounds, ...)


This works only for tiny areas because it assumes linear mapping.

2. Instead: Reproject the raster before display

Use rasterio.warp.reproject (or GDAL equivalent):

import numpy as np
import rasterio
from rasterio.transform import from_origin
from rasterio.warp import reproject, Resampling, calculate_default_transform
from rasterio.transform import array_bounds

# Suppose z is your raster array in NZTM (EPSG:2193)
# and you know west/east/south/north in metres
xres = (east - west) / (z.shape[1])
yres = (north - south) / (z.shape[0])

# Build transform for NZTM
transform_src = from_origin(west, north, xres, yres)

src_crs = "EPSG:2193"
dst_crs = "EPSG:4326"

# Compute target transform/shape
dst_transform, dst_width, dst_height = calculate_default_transform(
    src_crs, dst_crs, z.shape[1], z.shape[0], west, south, east, north
)

dst = np.empty((dst_height, dst_width), dtype=z.dtype)

reproject(
    source=z,
    destination=dst,
    src_transform=transform_src,
    src_crs=src_crs,
    dst_transform=dst_transform,
    dst_crs=dst_crs,
    resampling=Resampling.bilinear,
)

# Get geographic bounds in WGS84
south, west, north, east = array_bounds(dst_height, dst_width, dst_transform)

bounds = [[south, west], [north, east]]

# Now use in Folium
folium.raster_layers.ImageOverlay(image=dst, bounds=bounds, opacity=0.7).add_to(map)

3. Why This Fix Works

The reprojection step bends the raster so it matches the Earth’s curvature.

Each pixel is remapped properly into WGS84 space.

You stop accumulating distortion when tiling many rasters, because each tile is warped individually before display.

The error no longer scales with area size.